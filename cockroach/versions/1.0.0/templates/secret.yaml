kind: secret
name: {{ .Values.secret.name }}
description: cockroach config and secrets

type: opaque
data:
  encoding: plain
  payload: |-
    {{ .Values | toYaml | nindent 4 }}

{{- if not .Values.cockroach_defaults.insecure }}
kind: secret
name: {{ .Values.certs.secret_name }}
description: CockroachDB TLS certificates
type: opaque
data:
  encoding: base64
  payload: |
    ca.crt: {{ .Files.Get "certs/ca.crt" | b64enc }}
    node.crt: {{ .Files.Get "certs/node.crt" | b64enc }}
    node.key: {{ .Files.Get "certs/node.key" | b64enc }}
{{- end }}
