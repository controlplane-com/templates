---
kind: secret
name: {{ .Release.Name }}-coraza-custom-rules
description: Coraza WAF custom rules
type: opaque
data:
  encoding: plain
  payload: |-
    # Add your custom rules here

    # Example Rule: block requests containing "attack" in the URI
    # Test by querying the endpoint with /attack
    
    SecRule REQUEST_URI "@rx attack" "id:1001,phase:1,deny,msg:'Blocked attack attempt'"